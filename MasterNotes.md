# Workflow/pipeline details for the Culex biting RNA-seq analysis

## Upstream 
Information about sequence reads (raw read count, read alignment rate, etc.) for the data can be found [here](https://docs.google.com/spreadsheets/d/1y15EVJ7VUNeKWtLNaBUMJ1zZaR_LLv7YgWeYWtGrIpI/edit?usp=sharing)

### Data Accession
Data was generated by collaborator...

Add accession notes here

### Preprocessing and Quality Control

Trimmomatic (version 0.39) was used to trim sequence reads based on quality ([script](https://github.com/srmarzec/Culex_Biting_RNAseq/blob/main/Upstream/trim.sh))

FastQC (v0.11.9) was used for quality control visualization ([script](https://github.com/srmarzec/Culex_Biting_RNAseq/blob/main/Upstream/fastqc.sh))

Preliminary trimming and fastqc showed a poor "per sequence base content" for the first ~15 bases. We decided to use HEADCROP flag to remove the first 15 bases. All other flags (TRAILING, SLIDINGWINDOW, and MINLEN) are rather general/default for basic quality of bases and did not result in much difference of trimming.

Most samples have warnings or fail for "per sequence GC content" and "sequence duplication levels", which I sort of expect based on RNAseq data. An interesting occurence, using the HEADCROP flag to remove the first 15 bases results in all samples failing "per sequence tile quality", while trimming without HEADCROP results only in a warning for this. This is likely because the samples are now being measured over 135b instead of 150b, which I guess makes this check fail for sequence tile quality.

"Overrepresented sequences" all blast to Culex (and related mosquitoes) or else are too repetitive to map to any organism. All the overrepresented sequences from each sample can be found [here](https://github.com/srmarzec/Culex_Biting_RNAseq/blob/main/misc/OverrepSequences.txt), annotated with whether they could be blasted mapped and to what.

### Mapping

Mapping was done using the *Culex quinquefasciatus* reference genome ([GCF_015732765.1](https://www.ncbi.nlm.nih.gov/assembly/GCF_015732765.1/)) found on NCBI

STAR (v2.7.1a) was used for indexing the genome ([script](https://github.com/srmarzec/Culex_Biting_RNAseq/blob/main/Upstream/STAR_index.sh)).

Reads were mapped in a two pass method. The first pass followed typical method with splice junctions from annotations ([script](https://github.com/srmarzec/Culex_Biting_RNAseq/blob/main/Upstream/STAR_map.sh)). The second pass is similar except that it additionally uses the output splice junctions info from the first pass (these would be novel splice junctions) to facilitate mapping ([script](https://github.com/srmarzec/Culex_Biting_RNAseq/blob/main/Upstream/STAR_map_twopass.sh)).

Output sam files were converted to bam and then indexed ([script](https://github.com/srmarzec/Culex_Biting_RNAseq/blob/main/Upstream/sam2bam.sh))

### Generating count matrix with HTSeq (htseq-count)

HTSeq (v0.13.5) was used to counts reads mapped to genes for downstream analyses ([script](https://github.com/srmarzec/Culex_Biting_RNAseq/blob/main/Upstream/htseq_count.sh))

## Downstream

### DESeq

### GO Enrichment

### KEGG Pathway Enrichment
